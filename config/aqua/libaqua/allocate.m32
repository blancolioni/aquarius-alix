.data
__heap_start:
   .word 0
   
__heap_top:
   .word 0
   
.export __allocate
__allocate:
   mov r1, -(sp)
   mov r0, r1
   mov __heap_top, r0
   bne L1
   trap 1
   mov r0, __heap_start
   mov r0, __heap_top
L1:
   add r0, r1, __heap_top
   mov (sp)+, r1
   rts
   
   
.export system__memory__mem__allocate
system__memory__mem__allocate:
   mov r0, -(sp)
   mov 12(sp), r0
   jsr __allocate
   mov (sp)+, r0
   rts
